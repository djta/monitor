var K={UI:{}},KUI={},KForm={},KValidate={},KURL={},$$={};
(function(){$$={str:{trim:function(a){return(a||"").replace(/^\s+|\s+$/g,"")},len:function(a,b){if(b)a=this.trim(a);for(var c=b=0;c<a.length;c++)if(a.charCodeAt(c)>255)b+=2;else b++;return b},sub:function(a,b,c){if(c)a=this.trim(a);for(var d=c=0,e=0,h=0;h<b;h++){if(a.charCodeAt(h)>255)c+=2;else d+=1;e+=1;if(c+d==b)return a.substring(0,e);if(c+d>b)return a.substring(0,e-1)}},subs:function(a,b,c,d){d||(d="...");return this.len(a,c)>b?this.sub(a,b,c)+d:c?this.trim(a):a}}};var j=function(){},q=false,
v=/xyz/.test(function(){})?/\b_super\b/:/.*/;j.extend=function(a){function b(){!q&&this.init&&this.init.apply(this,arguments)}var c=this.prototype;q=true;var d=new this;q=false;for(var e in a)d[e]=typeof a[e]=="function"&&typeof c[e]=="function"&&v.test(a[e])?function(h,g){return function(){var l=this._super;this._super=c[h];var p=g.apply(this,arguments);this._super=l;return p}}(e,a[e]):a[e];b.prototype=d;b.constructor=b;b.extend=arguments.callee;return b};j=j.extend({init:function(){this._events=
{}},trigger:function(a,b,c){if($.isArray(this._events[a])){var d={targetObj:this};if($.type(c)=="object")d=$.extend(d,c);b=b||[];b=[d].concat(b);for(c=0;c<this._events[a].length;c++){d=this._events[a][c];$.isFunction(d)&&d.apply(this,b)}}},bind:function(a,b){if($.isArray(this._events[a]))this._events[a].push(b);else this._events[a]=[b]},unbind:function(a,b){if($.isFunction(b)){if($.isArray(this._events[a])&&$.inArray(b,this._events[a])>=0){b=$.inArray(b,this._events[a]);this._events[a].splice(b,1)}}else this._events[a]=
[]},wrap:function(a,b){b=b||this;return function(){return a.apply(b,arguments)}}});var f=new j;$.extend(f,{isLeftButton:function(a){a=window.event||a;if($.browser.msie&&a.button==1)return true;else if(a.button==0)return true;return false}});K.EventBase=j;K.Image={onLoaded:function(a){a=$(a);var b=a.attr("sw")?parseInt(a.attr("sw")):a.width(),c=a.attr("sh")?parseInt(a.attr("sh")):a.height(),d=parseInt(a.attr("w")),e=parseInt(a.attr("h")),h=a.attr("s")?parseInt(a.attr("s")):1,g={};g=(a.attr("m")?a.attr("m"):
"resize")=="enlarge"?this._enlarge(b,c,d,e,h):this._resize(b,c,d,e,h);a.attr("loaded")||a.attr({loaded:"loaded",sw:b,sh:c});b=a.attr("a")?parseInt(a.attr("a")):15;1&b&&a.css("width",g.width);2&b&&a.css("height",g.height);4&b&&a.css("margin-top",g.top);8&b&&a.css("margin-left",g.left);16&b&&a.css("top",g.top);32&b&&a.css("left",g.left)},_enlarge:function(a,b,c,d,e){a=parseInt(a);b=parseInt(b);c=parseInt(c);d=parseInt(d);e=!!e;if((a<=c||b<=d)&&!e)return{width:a,height:b,left:parseInt((c-a)/2),top:parseInt((d-
b)/2)};if(a/b>c/d){e=parseInt(a*d/b);return{width:e,height:d,left:parseInt((c-e)/2),top:0}}else{e=parseInt(b*c/a);return{width:c,height:e,left:0,top:parseInt((d-e)/2)}}},_resize:function(a,b,c,d,e){a=parseInt(a);b=parseInt(b);c=parseInt(c);d=parseInt(d);e=!!e;if(typeof e=="undefined")e=false;e=!!e;if(a<=c&&b<=d&&!e)return{width:a,height:b,left:parseInt((c-a)/2),top:parseInt((d-b)/2)};if(a/b>c/d){e=parseInt(b*c/a);return{width:c,height:e,left:0,top:parseInt((d-e)/2)}}else{e=parseInt(a*d/b);return{width:e,
height:d,left:parseInt((c-e)/2),top:0}}}};var n=K.EventBase.extend({init:function(a,b){this._super();this.config=$.extend({width:320,height:100},b||{});this.dom=a;if(!this.dom)this.dom=$('<div style="width:100%; height:100px; position:fixed; bottom:0; overflow-y:auto; font-size:9px; border:solid 1px #DED;"></div>').appendTo($("body"));this.dom.css({width:this.config.width,height:this.config.height});this.count=0},write:function(a){this.count++;this.dom.prepend("<p>"+this.count+": "+a+"</p>")}});KUI.Logger=
n;n._i=null;n.i=function(){if(!this._i)this._i=new n;return this._i};n.write=function(a){this.i().write(a)};f=K.EventBase.extend({init:function(a,b){this._super();var c=this;this.config=$.extend({width:400,height:148,horizontal:true,mouseType:"mouseenter",showTitle:true,auto:1E4,speed:400,defaultIndex:0,onIndexChanged:null},b||{});this.dom=a;this.dom.css({overflow:"hidden"});this.contents=this.dom.children("div");this.dom.append('            <div class="ui-slides-wheel">                <div class="ui-slides-group"></div>            </div>            <p class="ui-slides-dots"></p>            ');
this.contentList=this.dom.children("div.ui-slides-wheel");this.length=this.contents.length;this.contentListInner=this.contentList.children("div.ui-slides-group");this.contents.appendTo(this.contentListInner);this.dotsOuter=this.dom.children("p.ui-slides-dots");for(a=0;a<this.length;a++)this.dotsOuter.append('<b class=""></b>');this.dots=this.dotsOuter.children("b");this.contents.addClass("ui-slides-item").css("position","absolute");$(window).on("resize orientationchange",$.proxy(this.resetSize,this));
this.resetSize();this.currentIndex=-1;this.changeTo(this.config.defaultIndex,false);this.config.auto&&c.startAuto();this.contentList.swipeLeft(function(){c.changeToNext()});this.contentList.swipeRight(function(){c.changeToPrev()})},resetSize:function(){this.setSize($(window).width(),this.config.height)},setSize:function(a,b){var c=this;if(parseInt(a)>0){this.config.width=a;this.contentList.width(a);this.contents.width(a)}if(parseInt(b)>0){this.config.height=b;this.contentList.height(b);this.contents.height(b);
this.dom.height(b)}this.config.horizontal?this.contents.each(function(d){$(this).css({width:c.config.width,height:c.config.height,left:c.config.width*d})}):this.contents.each(function(d){$(this).css({width:c.config.width,height:c.config.height,top:c.config.height*d})});this.changeTo(this.currentIndex,false,true)},appendItem:function(){},startAuto:function(){var a=this;clearInterval(this.intervalId);this.intervalId=setInterval(function(){a.changeToNext(true)},this.config.auto)},stopAuto:function(){clearInterval(this.intervalId)},
getLength:function(){return this.contentList.find(">div >div.ui-slides-item")},changeTo:function(a,b,c){a=parseInt(a);if(!isNaN(a))if(!(this.currentIndex==a&&!c)){c=this.config.horizontal?0:-a*this.config.height;var d=this.config.horizontal?-a*this.config.width:0;if(typeof b=="undefined")b=true;b?this.contentList.animate({top:c,left:d},this.config.speed,function(){}):this.contentList.css({top:c,left:d});b=this.currentIndex;this.currentIndex=a;this.dots.removeClass("ui-slides-dot-select").eq(this.currentIndex).addClass("ui-slides-dot-select");
$.isFunction(this.config.onIndexChanged)&&this.config.onIndexChanged.call(this,b,a)}},changeToPrev:function(a){var b=this.currentIndex-1;if(b<0)b=this.length-1;this.changeTo(b,a);this.config.auto&&this.startAuto()},changeToNext:function(a){var b=this.currentIndex+1;if(b>=this.length)b=0;this.changeTo(b,a);this.config.auto&&this.startAuto()}});KUI.SlidesBase=f;f=K.EventBase.extend({init:function(a,b){var c=this;this.dom=a;this.wrapper=this.dom.children("div.m_panel_wrapper");this.wrapper.iScroll();
this.config=$.extend({},b||{});this.close(false);$(window).on("resize onorientchanged",function(){c.resetSize()});$(document).on("click",function(){c.close()});this.dom.swipeLeft(function(){c.close()});this.dom.on("click",function(d){d.stopPropagation()});this.dom.find("a.m_panel_item").highlight("m_panel_item_hover")},resetSize:function(){var a=this.getWidth(),b=this.getHeight();this.closed?this.dom.css({top:0,left:-a,width:a,height:b}):this.dom.css({left:0,top:0,width:a,height:b});this.wrapper.css({width:a,
height:b}).iScroll("refresh")},getWidth:function(){return $(window).width()-80},getHeight:function(){return $(window).height()},open:function(){this.dom.show();this.resetSize();this.closed=false;this.dom.animate({left:0},"fast")},close:function(a){var b=this;if(typeof a=="undefined")a=true;a=!!a;this.closed=true;if(a)this.dom.animate({left:-this.getWidth()},{duration:"fast",complete:function(){b.closed&&b.dom.hide()}});else{this.dom.css({left:-this.getWidth()});this.dom.hide()}},toggle:function(){this.closed?
this.open():this.close()}});KUI.ListPanel=f;f=K.EventBase.extend({init:function(){var a=this;this.dom=$(".m_page");this.domInner=this.dom.children(".m_page_inner");this.domWrapper=this.dom.find(".m_page_wrapper");this.domScroller=this.dom.find(".m_page_scroller");this.iScroll=this.domWrapper.iScroll({checkDOMChanges:true});this.views=this.domScroller.children("div");this.viewLoading=this.views.filter(".m_page_view_loading");this.viewSuccess=this.views.filter(".m_page_view_success");this.viewFailure=
this.views.filter(".m_page_view_failure");this.initFailure();this.titleHeight=42;this.titleBackBtn=this.dom.find(".m_top_title .btn_back");this.titleBackBtn.click(function(b){b.stopPropagation();setTimeout(function(){a.close()},300)});this.titleBackBtn.highlight("btn_tap");this.titleText=this.dom.find(".m_top_title p.title");this.titleRefreshBtn=this.dom.find(".m_top_title .btn_refresh");this.titleRefreshBtn.tap(function(){a.retry()}).highlight("btn_tap");$(window).on("resize onorientalchanged",function(){a.resetSize()});
this.close(false);this.dom.swipeRight(function(){a.close()});this.dom.tap(function(b){b.stopPropagation()});this.title=this.srcStr=""},showLoading:function(){this.views.hide();this.viewLoading.show();this.domWrapper.iScroll("scrollTo",0,0,0)},showSuccess:function(){this.views.hide();this.viewSuccess.show()},initFailure:function(){var a=this;this.btnRetry=this.viewFailure.find("button.retry");this.btnRetry.on("click",function(){a.retry()});this.spanMsg=this.viewFailure.find("span.msg")},showFailure:function(a){this.views.hide();
this.spanMsg.text(a||"\u52a0\u8f7d\u5931\u8d25");this.viewFailure.show()},resetSize:function(){var a=this.getWidth(),b=this.getHeight();a=this.getWidth();b=this.getHeight();this.closed?this.dom.css({top:0,left:a,width:a,height:b}):this.dom.css({top:0,left:0,width:a,height:b});this.views.css("min-height",b);this.domWrapper.css("height",b-this.titleHeight)},getWidth:function(){return $(window).width()},getHeight:function(){return $(window).height()},setTitle:function(a){this.titleText.text(a)},retry:function(){this.open(this.srcStr,
this.title)},open:function(a,b){var c=this;this.resetSize();this.dom.show();this.closed=false;this.dom.animate({left:0},"fast");this.srcStr=a;this.title=b||"";this.setTitle(b);c.showLoading();this.btnRetry.attr("open-str",a);$.ajax({url:"/",type:"post",data:{app:"sys",action:"cgi/m_page_view",str:a},dataType:"json",beforeSend:function(){c.showLoading()},success:function(d){if(d.code===0){c.viewSuccess.html(d.data.html);c.showSuccess()}else c.showFailure(d.message)},error:function(){c.showFailure("\u6570\u636e\u51fa\u9519\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5")}})},
close:function(a){var b=this;if(typeof a=="undefined")a=true;a=!!a;this.closed=true;if(a){this.domWrapper.iScroll("scrollToElement",this.viewSuccess);setTimeout(function(){b.dom.animate({left:b.getWidth()},{duration:"fast",complete:function(){b.closed&&b.dom.hide()}})},200)}else{this.dom.css({left:this.getWidth()});this.dom.hide()}}});KUI.PageLayout=f;var m={FAIL:"validate_fail",OK:"validate_ok",RESULT:"validate_result",FORM_RESULT:"validate_form_result",FORM_RESET:"validate_form_reset"};this.ValidateEvent=
m;KValidate.Event=m;var k=j.extend({init:function(a,b){this._super();this.dom=a;this.config=b},focus:function(){this.dom.focus()},validate:function(){this.triggerResult(0);return true},triggerResult:function(a,b){var c="";if(this.config.map&&this.config.map[a])c=this.config.map[a].toString();if(b)c=b;this.trigger(m.RESULT,[a,c]);return a===0}});KValidate.ValidateBase=k;var i=k.extend({init:function(a,b){this._super(a,b);this.config=$.extend({allowEmpty:false,trim:true},this.config);var c=this;this.dom.blur(function(){c.validate()})},
preValidate:function(){var a=$(this.dom).val();if(this.config.trim){var b=$.trim(a);if(b!==a){a=b;$(this.dom).val(a)}}if($$.str.len(a)<=0)return this.config.allowEmpty?0:1;return 2}}).extend({init:function(a,b){b=$.extend({maxLength:0,minLength:0,allowEmpty:false,trim:true,map:{0:"\u8f93\u5165\u6b63\u786e",1:"\u4e0d\u80fd\u4e3a\u7a7a",10:"\u8d85\u51fa\u5b57\u6570\u4e0a\u9650",11:"\u5b57\u6570\u592a\u5c11"}},b||{});this._super(a,b)},lengthValidate:function(){var a=$(this.dom).val();a=$$.str.len(a);
if(this.config.maxLength>0&&a>this.config.maxLength)return 10;if(a<this.config.minLength)return 11;return 0},validate:function(){var a=this.preValidate();if(a<2)return this.triggerResult(a);a=this.lengthValidate();if(a>=10&&a<20)return this.triggerResult(a);return this.triggerResult(0)}});KValidate.Strlen=i;f=i.extend({init:function(a,b){b=$.extend({compareWith:null,map:{0:"\u8f93\u5165\u6b63\u786e",1:"\u4e0d\u80fd\u4e3a\u7a7a",10:"\u8d85\u51fa\u5b57\u6570\u4e0a\u9650",11:"\u5b57\u6570\u592a\u5c11",
21:"\u8f93\u5165\u4e0d\u76f8\u540c"}},b||{});this._super(a,b)},validate:function(){var a=this.preValidate();if(a<2)return this.triggerResult(a);a=this.lengthValidate();if(a>=10&&a<20)return this.triggerResult(a);if(this.config.compareWith)return this.dom.val()==this.config.compareWith.val()?this.triggerResult(0):this.triggerResult(21);return this.triggerResult(0)}});KValidate.Compare=f;f=i.extend({init:function(a,b){b=$.extend({patterns:[],matchAll:false,map:{0:"\u8f93\u5165\u6b63\u786e",1:"\u4e0d\u80fd\u4e3a\u7a7a",
10:"\u8d85\u51fa\u5b57\u6570\u4e0a\u9650",11:"\u5b57\u6570\u592a\u5c11",0:"\u8f93\u5165\u6b63\u786e",20:"\u8f93\u5165\u4e0d\u89c4\u8303"}},b||{});if(!$.isArray(b.patterns))b.patterns=[b.patterns];for(var c=0;c<b.patterns.length;c++){var d=b.patterns[c];if($.type(d)=="string")d=new RegExp(d,"gi");b.patterns[c]=d}this._super(a,b)},validate:function(){var a=this.preValidate();if(a<2)return this.triggerResult(a);a=this.lengthValidate();if(a>=10&&a<20)return this.triggerResult(a);a=false;var b=true,c=
this.dom.val();if(this.config.patterns.length)for(var d=0;d<this.config.patterns.length;d++)if(c.match(this.config.patterns[d]))a=true;else b=false;return this.config.matchAll?b?this.triggerResult(0):this.triggerResult(20):a?this.triggerResult(0):this.triggerResult(20)}});KValidate.Pattern=f;var r=f.extend({init:function(a,b){b=$.extend({patterns:[/^\d{4}\-\d{2}\-\d{2}\s\d{2}\:\d{2}\:\d{2}$/gi],matchAll:false,map:{0:"\u8f93\u5165\u6b63\u786e",1:"\u4e0d\u80fd\u4e3a\u7a7a",10:"\u8d85\u51fa\u5b57\u6570\u4e0a\u9650",
11:"\u5b57\u6570\u592a\u5c11",0:"\u8f93\u5165\u6b63\u786e",20:"\u8bf7\u6309\u7167\u6b64\u683c\u5f0f\u8f93\u5165: 2012-05-06 12:05:00"}},b||{});this._super(a,b)}});KValidate.DateTime=r;r=i.extend({init:function(a,b){b=$.extend({map:{0:"\u8f93\u5165\u6b63\u786e",1:"\u4e0d\u80fd\u4e3a\u7a7a",10:"\u8d85\u51fa\u5b57\u6570\u4e0a\u9650",11:"\u5b57\u6570\u592a\u5c11"},minLength:4,maxLength:4},b||{});this._super(a,b)},validate:function(){var a=this.preValidate();if(a<2)return this.triggerResult(a);a=this.lengthValidate();
if(a===10||a===11)return this.triggerResult(a);return this.triggerResult(0)}});KValidate.VCode=r;i=i.extend({init:function(a,b){b=$.extend({map:{0:"\u8f93\u5165\u6b63\u786e",1:"\u4e0d\u80fd\u4e3a\u7a7a",10:"\u8d85\u51fa\u5b57\u6570\u4e0a\u9650",11:"\u5b57\u6570\u592a\u5c11",20:"\u8f93\u5165\u4e0d\u7b26\u5408\u89c4\u8303",21:"\u6570\u5b57\u592a\u5c0f",22:"\u6570\u5b57\u592a\u5927"},minNumber:0,maxNumber:0,canFloat:1},b||{});this._super(a,b)},validate:function(){var a=this.preValidate();if(a<2)return this.triggerResult(a);
a=this.lengthValidate();if(a===10||a===11)return this.triggerResult(a);a=$(this.dom).val();$$.str.len(a);var b=this.config.canFloat?/^[0-9]+(\.[0-9]+)?$/gi:/^[0-9]+$/gi;if(!a.toString().match(b))return this.triggerResult(20);if(this.config.maxNumber>this.config.minNumber){if(a<this.config.minNumber)return this.triggerResult(21);if(a>this.config.maxNumber)return this.triggerResult(22)}return this.triggerResult(0)}});KValidate.Number=i;i=k.extend({init:function(a){this._super(a,{map:{0:"\u5df2\u9009\u62e9",
1:"\u8bf7\u9009\u62e9\u4e00\u4e2a"}});var b=this;this.dom.click(function(){b.validate()})},validate:function(){if(this.dom.filter(":checked").length)return this.triggerResult(0);return this.triggerResult(1)}});KValidate.RadioSelect=i;i=k.extend({init:function(a){this._super(a,{map:{0:"\u5df2\u9009\u62e9",1:"\u8bf7\u9009\u62e9\u4e00\u4e2a"}});var b=this;this.dom.change(function(){b.validate()})},validate:function(){if($(this.dom).find(":selected").is("[value]"))return this.triggerResult(0);return this.triggerResult(1)}});
KValidate.Select=i;k=k.extend({init:function(a){this._super(a,{least:1,map:{0:"\u5df2\u9009\u62e9",1:"\u9009\u62e9\u7684\u4e2a\u6570\u4e0d\u591f"}});var b=this;this.dom.click(function(){b.validate()})},validate:function(){if(this.dom.filter(":checked").length>=this.config.least)return this.triggerResult(0);return this.triggerResult(1)}});KValidate.CheckboxSelect=k;k=f.extend({init:function(a,b){b=$.extend({type:"all",patterns:[/^\d{11}$/i,/^\d{3,4}\-?\d{7,8}$/i],allowEmpty:false},b||{});b.patterns=
b.type=="mobile"?[/^1\d{10}$/i]:b.type=="phone"?[/^0\d{2,3}\-?\d{7,8}$/i]:[/^1\d{10}$/i,/^0\d{2,3}\-?\d{7,8}$/i];this._super(a,b)}});KValidate.Phone=k;f=f.extend({init:function(a,b){b=$.extend({patterns:[/^(\w)+(\.\w+)*@(\w)+((\.\w{2,3}){1,3})$/i],allowEmpty:false},b||{});this._super(a,b)}});KValidate.Email=f;var o=j.extend({init:function(a,b){this._super();if(a){this.form=a=$(a);this.config=$.extend({ajax:false,ajaxConfig:{},submitBtn:null,method:"post",action:"",showValidateResult:true,baseData:{}},
b||{});this.validates=[];if(this.form.attr("method"))this.config.method=this.form.attr("method").toString().toLowerCase();if(this.form.attr("action"))this.config.action=this.form.attr("action");var c=this;this.config.ajax&&this.form.attr("onsubmit","javascript:return false;");var d=function(){if(!c.validateAll())return false;if(c.config.ajax){var e=$.extend({url:c.config.action,type:c.config.method,data:$.extend({},c.config.baseData,o.collect(c.form))},c.config.ajaxConfig);$.ajax(e);return false}return true};
this.config.submitBtn?this.config.submitBtn.click(function(){d()}):this.form.submit(function(){d()})}},collect:function(){var a={},b=this;$(this.form).find("input[name]").each(function(){var c=$(this).attr("type"),d=$(this).attr("name");if(c){c=c.toLowerCase();if(c=="text"||c=="select"||c=="radio"||c=="hidden"||c=="password")a[d]=$(this).val();else if(c=="checkbox")if($(b.form).find("input[name="+d+"]:checked").length)a[d]="on"}});$(this.form).find("textarea[name]").each(function(){a[$(this).attr("name")]=
$(this).val()});return a},validateAll:function(){for(var a=true,b=null,c=0;c<this.validates.length;c++)if(!this.validates[c].validate()){b||(b=this.validates[c]);a=false}b&&b.focus();return a},addValidate:function(a){this.validates.push(a);a.bind(m.RESULT,this.wrap(function(b,c,d){this.config.showValidateResult&&this.showValidateResult(b.targetObj,c,d);this.trigger(m.FORM_RESULT,[b.targetObj,c,d])}))},showValidateResult:function(a,b,c){var d=a.dom,e=d.parents(".form_item");if(e.length<=0)e=d.parents("tr");
if(!(e.length<=0)){d=e.find(".check");e=d.find(".check_result");if(!(d.length<=0)){d.removeClass("check_right check_wrong").show();if(b===0){d.addClass("check_right");a.dom.removeClass("check_wrong")}else{d.addClass("check_wrong");a.dom.addClass("check_wrong")}d.find(".check_icon").attr("title",c).css("cursor","help");e.text(c)}}},reset:function(){this.form.find("input.text,textarea").val("");this.form.find(".check .check_result").html("");this.trigger(m.FORM_RESET)}});o.collect=function(a){var b=
{};$(a).find("input[name]").each(function(){var c=$(this).attr("type"),d=$(this).attr("name");if(c){c=c.toLowerCase();if(c=="text"||c=="password"||c=="select"||c=="hidden")b[d]=$(this).val();else if(c=="checkbox"){if($(a).find("input[name="+d+"]:checked").length)b[d]="on"}else if(c=="radio")if($(this).is(":checked"))b[d]=$(this).val()}});$(a).find("textarea[name],select[name]").each(function(){b[$(this).attr("name")]=$(this).val()});return b};o.assign=function(a,b){if(b)for(var c in b){var d=b[c],
e=$(a).find("input[name="+c+"],select[name="+c+"],textarea[name="+c+"]"),h=e.attr("type");e.get(0).tagName.toLowerCase();h=="radio"?e.filter("[value="+d+"]").attr("checked","checked"):e.val(d)}};this.KForm=o;K.Form=o;K.URL={getCurrentUrl:function(){return window.location.href},getParams:function(a){if(typeof a!="string")a=this.getCurrentUrl();a=a.match(/(\?|\&)([^\=]+)\=([^\&]+)/gi);var b={};if(a&&a.length)for(var c=0;c<a.length;c++){var d=a[c].match(/^(\?|\&)([^\=]+)\=([^\&]+)$/i);b[d[2]]=decodeURIComponent(d[3])}return b},
getParam:function(a){var b=this.getParams();if(typeof b[a]!=="undefined")return b[a];return null},getDomain:function(a){if(typeof a!="string")a=this.getCurrentUrl();var b="";if(match=a.match(/^http\:\/\/([^\/]+)/i))b=match[1];return b},getPath:function(){return window.location.pathname}};$.extend($.fn,{vcode:function(){if(!($(this).length<=0)){var a=arguments,b="init";if(typeof a==="undefined"||typeof a[0]==="object")b="init";else if(typeof a[0]==="string")b=a[0];if(b=="init"){if($(this).attr("vcode")===
"vcode")return;$(this).attr("vcode","vcode");var c=$.extend({initType:null,url:"/vcode/get.html?v={$rand}&h={$h}",preUrl:"http://ss.yunimg.cn/statics/sys/vcode_def_{$h}.png",height:24,formAuto:true,inputAuto:true},a[0]);$(this).get(0).vcode_config=c;if(c.initType==="pre")$(this).attr("src",c.preUrl.replace("{$h}",c.height));else c.initType==="vcode"&&$(this).attr("src",c.url.replace("{$h}",c.height).replace("{$rand}",Math.random()));$(this).click(function(){$(this).attr("src",c.url.replace("{$h}",
c.height).replace("{$rand}",Math.random()))}).css({cursor:"pointer"});var d=$(this),e=function(){if(d.attr("vcode-auto")!="1"){d.attr("vcode-auto","1");d.vcode("refresh")}};if(c.formAuto)a=$(this).parents("form,.form_list").find("input,textarea").focus(function(){e()});else if(c.inputAuto)a=$(this).siblings("input:text").focus(function(){e()})}else if(b=="refresh")(c=$(this).get(0).vcode_config)&&$(this).attr("src",c.url.replace("{$h}",c.height).replace("{$rand}",Math.random()));return $(this)}}});
K.UI.Base=K.EventBase.extend({className:"Base",baseConfig:{autoStart:true},init:function(a,b){if(a&&a.length){this.setDom(a);this.setConfig(b);this.render();this.dom.data("k.ui",this)}},setDom:function(a){this.dom=a},setConfig:function(a){this.config=$.extend({},this.baseConfig,a||{})},beforeAction:function(){},setup:function(){this.mode="setup";this.beforeAction();this.setupAction();this.afterAction();this.autoStart()},setupAction:function(){},render:function(){this.mode="render";this.beforeAction();
this.renderAction();this.afterAction();this.autoStart()},renderAction:function(){},afterAction:function(){},autoStart:function(){if(typeof this.config.autoStart=="undefined"||this.config.autoStart===true)this.start()},start:function(){this.fire("started")},getMode:function(){return this.mode},wrap:function(a){var b=this;return function(){Array.prototype.shift.apply(arguments);return a.apply(b,arguments)}},on:function(a,b){this.dom.on(a+".kui",this.wrap(b))},fire:function(a,b){var c=s("on_"+a);$.isFunction(this.config[c])&&
this.config[c].apply(this,b);this.dom.trigger(a+".kui",b)}});var s=function(a){if(a.indexOf("-")<0&&a.indexOf("_")<0)return t(a);return t(a.replace(/[-_][^-_]/g,function(b){return b.charAt(1).toUpperCase()}))},t=function(a){if($.type(a)=="string"&&a.length)return a[0].toLowerCase()+a.substring(1);return a};K.Comp={};K.Comp.Base=K.EventBase.extend({clsName:"CompBase",tagName:"div",baseConfig:{cls:"kui_comp",outer:null,show:true,unloadOnHide:false},init:function(a,b){this._super();this.started=false;
this.setConfig(a);this.dom=$(document.createElement(this.tagName)).appendTo(this.config.outer||K.TempOuter.i());this.uni=this.clsName+K.Utils.uniqueKey();this.dom.attr("kui-uni",this.uni);this.dom.data(this.clsName,this);this.dom.hide();this.shown=false;this.dom.addClass("k-comp");this.dom.addClass($.type(this.config.cls)==="string"?this.config.cls:"");$.isFunction(b)&&b.call(this);this.setupAction();this.firstShown=false;this.config.show&&this.show()},setConfig:function(a){this.config=$.extend({},
this.baseConfig,a||{});return this},isShown:function(){return this.shown},show:function(){if(this.shown)return this;this.dom.show();this.shown=true;if(!this.firstShown){this.firstShown=true;this.firstShow()}this.trigger("shown");return this},hide:function(){if(!this.shown)return this;this.dom.hide();this.shown=false;this.trigger("hidden");this.config.unloadOnHide&&this.unload();return this},setupAction:function(){},firstShow:function(){},trigger:function(a,b){var c=s("on_"+a);$.isFunction(this.config[c])&&
this.config[c].apply(this,b);this._super(a,b)},unload:function(){this.dom.remove()}});j={inited:false,i:function(){if(this.inited)return this.dom;$("#global_temp_outer").length<=0&&$('<div id="global_temp_outer" style="width:0px; height:0px;"></div>').appendTo($("body"));return this.dom=$("#global_temp_outer")},append:function(a){this.i();this.dom.append(a)},clear:function(){this.i();this.dom.empty()}};K.ZIndex={LEVEL_STEP:1E5,Level:{BG:10,PAGES:20,MODAL:30,40:40,50:50,CTX_MENU:60,70:70,80:80,TOP:90},
rename:function(a){if(a)this.Level=$.extend(this.Level,a)},parseLevel:function(a){if(this.Level[a])return this.Level[a];if(parseInt(a)>0)return parseInt(a);return 0},levelRange:{},getCenter:function(a){return a*this.LEVEL_STEP+this.LEVEL_STEP/2},getTop:function(a){var b=this.getCenter(a);if(typeof this.levelRange[a]=="undefined")this.levelRange[a]={max:b,min:b};b=this.levelRange[a].max;b++;return this.levelRange[a].max=b},getMax:function(a){return a*this.LEVEL_STEP+this.LEVEL_STEP-1},getBottom:function(a){if(typeof this.levelRange[a]==
"undefined"){var b=this.getCenter(a);this.levelRange[a]={max:b,min:b}}b=this.levelRange[a].min;b--;return this.levelRange[a].min=b},getMin:function(a){return a*this.LEVEL_STEP},mark:function(a){var b=Math.floor(a/this.LEVEL_STEP);if(typeof this.levelRange[b]=="undefined"){var c=this.getCenter(b);this.levelRange[b]={max:c,min:c}}if(a>this.levelRange[b].max)this.levelRange[b].max=a;if(a<this.levelRange[b].min)this.levelRange[b].min=a}};K.TempOuter=j;K.Utils={toHtml:function(a){if(typeof a=="undefined")return"";
if($.type(a)!=="string")a=a.toString();return a.replace(/\<script/g,"<******").replace(/\&lt;script/g,"<******").replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},rand:function(a){a=parseInt(a);return isNaN(a)||!a?Math.random():Math.round(Math.random()*Math.pow(10,a))},uniqueKey:function(a){return(a?a+"_":"")+(+new Date).toString()+this.rand(3)},wrap:function(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}},
_jpId:{},jsonp:function(a,b,c,d,e){var h=this;b+=Math.round(Math.random()*1E5);this._jpId[b]&&clearTimeout(this._jpId[b]);this._jpId[b]=null;var g=document.getElementsByTagName("head")[0],l=document.createElement("script");l.setAttribute("type","text/javascript");window[b]=function(u){h._jpId[b]&&clearTimeout(h._jpId[b]);window[b]=undefined;try{delete window[b]}catch(w){}g&&g.removeChild(l);c(u)};var p=5E3;if(typeof e=="number")p=e;if(typeof d=="function")this._jpId[b]=setTimeout(function(){clearTimeout(h._jpId[b]);
window[b]=undefined;try{delete window[b]}catch(u){}g&&g.removeChild(l);d()},p);l.src=a+b;g.appendChild(l)},guid:function(){for(var a="",b=1;b<=32;b++){var c=Math.floor(Math.random()*16).toString(16);a+=c;if(b==8||b==12||b==16||b==20)a+="-"}return a},ucFirst:function(a){if($.type(a)=="string"&&a.length)return a.substring(0,1).toUpperCase()+a.substring(1);return a},toCamel:function(a,b){if($.type(a)=="string"&&a.length){if(b)a=a.substring(0,1).toUpperCase()+a.substring(1);for(b=0;a.indexOf("_")>=0;){b++;
if(b>5)break;var c=a.indexOf("_");a=a.substring(0,c)+a.substring(c+1,c+2).toUpperCase()+a.substring(c+2)}}return a}};$.fn.setup=function(a,b,c){var d=null;$(this).each(function(){var e=$(this).data("k.ui");if(!e){e=new K.UI[a];$(this).data("k.ui",e);e.setDom($(this));e.setConfig(b);e.setup(c)}d||(d=e)});return d};K.UI.render=function(a,b,c){a=$(a);var d=a.data("k.ui");if(!d){d=new K.UI[b];a.data("k.ui",d);d.setDom(a);d.setConfig(c);d.render()}return d}})();